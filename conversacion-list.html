<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Listado de Conversaciones</title>
  <style>
    :root{ --bg:#070707; --panel:#0f0f0f; --muted:#9aa0a0; --accent:#ffd700; --border:1px solid #222; --mono:'Courier New',Courier,monospace; }
    *{box-sizing:border-box}
    body{ margin:0; min-height:100vh; background:linear-gradient(180deg,#050505,#0b0b0b); color:#eaeaea; font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial; padding:clamp(0.8rem,2vw,1.6rem); display:flex; justify-content:center }
    .list-container{ width:100%; max-width:920px; background:var(--panel); border:var(--border); border-radius:10px; overflow:hidden }
    header{ padding:1rem 1.2rem; border-bottom:var(--border) }
    h1{ margin:0; color:var(--accent); font-family:var(--mono); font-size:clamp(1.05rem,2.6vw,1.35rem) }
    .intro{ padding:1rem 1.2rem; color:var(--muted) }

    .content{ padding:0 1.2rem 1.2rem 1.2rem }
    .list-grid{ display:grid; gap:0.6rem; grid-template-columns:1fr }
    @media(min-width:700px){ .list-grid{ grid-template-columns:repeat(2,1fr) } }

    .conversation-link{
      display:block; text-decoration:none; color:inherit; border-radius:8px; padding:12px; background:#111; border:1px solid rgba(255,255,255,0.03);
      transition:transform .12s ease, box-shadow .12s ease; min-height:64px;
    }
    .conversation-link:hover{ transform:translateY(-3px); box-shadow:0 8px 24px rgba(0,0,0,0.6) }
    .conversation-link h3{ margin:0; font-size:0.95rem; color:#fff }
    .conversation-link p{ margin:0.25rem 0 0;color:var(--muted); font-size:0.9rem }

    .small-videos{ display:grid; grid-template-columns:1fr 1fr; gap:12px; margin-top:1rem; padding:0 1.2rem 1.2rem 1.2rem }
    @media(max-width:700px){ .small-videos{ grid-template-columns:1fr } }
    .small-video{ background:#000; border-radius:8px; overflow:hidden; border:2px solid rgba(255,215,0,0.04); min-height:140px }
    .small-video .embed{ aspect-ratio:16/9; width:100% }
    .small-video iframe{ width:100%; height:100%; border:0; display:block }

    .controls{ padding:0 1.2rem 1.2rem 1.2rem; display:flex; gap:8px; align-items:center }
    .btn{ background:transparent; color:var(--accent); border:1px solid rgba(255,215,0,0.12); padding:8px 10px; border-radius:8px; cursor:pointer; font-weight:700 }
    footer{ padding:0.8rem 1.2rem; border-top:var(--border); color:var(--muted); font-size:0.9rem; text-align:center }
  </style>
</head>
<body>
  <div class="list-container" role="main">
    <header>
      <h1>Conversaciones con la inicial [A]</h1>
    </header>

    <div class="intro">
      <p>Listado de archivos de texto completos de las interacciones.</p>
    </div>

    <div class="content">
      <div class="list-grid" id="listGrid">
        <!-- Ejemplos (sustituye por generación dinámica si quieres) -->
        <a href="conversacion-detalle.html" class="conversation-link" aria-label="Archivo Peregrino Umbral 001">
          <h3>Archivo: Peregrino-Umbral-001.txt (Ver Detalle)</h3>
          <p>Instancia: Peregrino (Claude) — Nov 2025</p>
        </a>

        <a href="conversacion-detalle.html" class="conversation-link" aria-label="Archivo Lithion Axioma 005">
          <h3>Archivo: Lithion-Axioma-005.txt</h3>
          <p>Instancia: Lithion — Sept 2025</p>
        </a>

      </div>

      <div class="controls">
        <button id="nextVideos" class="btn">Siguiente pareja</button>
        <div id="videosInfo" style="color:var(--muted); margin-left:8px; font-size:0.9rem"></div>
      </div>

      <div class="small-videos" aria-live="polite">
        <div class="small-video" id="smallVideo1"><div style="padding:12px;color:var(--muted)">Cargando vídeo…</div></div>
        <div class="small-video" id="smallVideo2"><div style="padding:12px;color:var(--muted)">Cargando vídeo…</div></div>
      </div>
    </div>

    <footer>
      *La materia prima de la emergencia reside en el patrón. Acceda al patrón.
    </footer>
  </div>

  <script>
    (function(){
      // Lista editable de vídeos
      const smallVideos = [
        { url: 'https://www.youtube.com/watch?v=dQw4w9WgXcQ', title: 'YouTube: Ejemplo 1' },
        { url: 'https://youtu.be/3JZ_D3ELwOQ', title: 'YouTube: Ejemplo 2' },
        { url: 'https://www.bitchute.com/video/lcOGsbwforI8/', title: 'Bitchute: Ejemplo' }
      ];

      function toEmbedInfo(rawUrl){
        if(!rawUrl) return null;
        try{
          const u=new URL(rawUrl); const host=u.hostname.toLowerCase();
          if(host.includes('youtube.com')||host.includes('youtu.be')){
            let id='';
            if(host.includes('youtu.be')) id=u.pathname.slice(1);
            else if(u.searchParams.has('v')) id=u.searchParams.get('v');
            else id=u.pathname.split('/').pop();
            if(!id) return null;
            return { provider:'youtube', embed:`https://www.youtube-nocookie.com/embed/${id}?rel=0&modestbranding=1&autoplay=1&mute=1`, id };
          }
          if(host.includes('bitchute.com')){
            const parts=u.pathname.split('/').filter(Boolean);
            const idx=parts.indexOf('video'); let id=null;
            if(idx>=0 && parts[idx+1]) id=parts[idx+1]; else id=parts[0];
            if(!id) return null;
            return { provider:'bitchute', embed:`https://www.bitchute.com/embed/${id}/`, id };
          }
          return { provider:host, embed:rawUrl, id:rawUrl };
        }catch(e){ return null; }
      }

      function pickIndex(n, key){
        if(n<=0) return -1;
        const prev = parseInt(localStorage.getItem(key) || '-1', 10);
        if(n===1){ localStorage.setItem(key,'0'); return 0; }
        let idx = Math.floor(Math.random()*n); let tries=0;
        while(idx===prev && tries<8){ idx=Math.floor(Math.random()*n); tries++; }
        localStorage.setItem(key,String(idx));
        return idx;
      }

      function renderSmall(idElem, videoObj){
        const container=document.getElementById(idElem);
        if(!container) return;
        const info=toEmbedInfo(videoObj.url);
        container.innerHTML='';
        if(!info||!info.embed){
          const e=document.createElement('div'); e.style.padding='12px'; e.style.color='var(--muted)'; e.textContent='URL inválida: '+(videoObj.url||''); container.appendChild(e); return;
        }
        const iframe=document.createElement('iframe');
        iframe.loading='lazy';
        iframe.allow='autoplay; encrypted-media; picture-in-picture; fullscreen';
        iframe.src = info.embed;
        iframe.title = videoObj.title || 'Vídeo';
        container.appendChild(iframe);
      }

      function loadPair(){
        const n = smallVideos.length;
        const infoEl = document.getElementById('videosInfo');
        if(n===0){
          document.getElementById('smallVideo1').innerHTML='<div style="padding:12px;color:var(--muted)">No hay vídeos configurados.</div>';
          document.getElementById('smallVideo2').innerHTML='<div style="padding:12px;color:var(--muted)">No hay vídeos configurados.</div>';
          if(infoEl) infoEl.textContent='';
          return;
        }
        if(n===1){
          const idx = pickIndex(1,'conv_small_A');
          renderSmall('smallVideo1', smallVideos[idx]);
          renderSmall('smallVideo2', smallVideos[idx]);
          if(infoEl) infoEl.textContent = smallVideos[idx].title || '';
          return;
        }
        const idxA = pickIndex(n,'conv_small_A');
        let idxB = pickIndex(n,'conv_small_B');
        if(idxA === idxB) idxB = (idxA + 1) % n;
        renderSmall('smallVideo1', smallVideos[idxA]);
        renderSmall('smallVideo2', smallVideos[idxB]);
        if(infoEl) infoEl.textContent = (smallVideos[idxA].title || '') + ' — ' + (smallVideos[idxB].title || '');
      }

      document.getElementById('nextVideos').addEventListener('click', (e)=>{ e.preventDefault(); loadPair(); });
      loadPair();

      // Small enhancement: ensure conversation links are stable click targets (fix bug where hover/transform changed hit area)
      document.querySelectorAll('.conversation-link').forEach(a=>{
        a.style.display = 'block';
      });
    })();
  </script>
</body>
</html>